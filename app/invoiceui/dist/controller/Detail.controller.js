sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","../model/formatter","sap/m/library","sap/ui/core/routing/History"],function(e,t,i,o,n){"use strict";var r=o.URLHelper;function a(e,t){var i=t.getObject().Quantity*t.getObject().UnitPrice;return e+i}return e.extend("invoiceui.controller.controller.Detail",{formatter:i,onInit:function(){this.getOwnerComponent().getRouter().getRoute("RouteDetail").attachPatternMatched(this._onObjectMatched,this)},onSendEmailPress:function(){var e=this.getModel("detailView");r.triggerEmail(null,e.getProperty("/shareSendEmailSubject"),e.getProperty("/shareSendEmailMessage"))},onListUpdateFinished:function(e){var t,i=0,o=e.getParameter("total"),n=this.getModel("detailView"),r=e.getSource().getBinding("items"),s;if(r.isLengthFinal()){if(o){t=this.getResourceBundle().getText("detailLineItemTableHeadingCount",[o])}else{t=this.getResourceBundle().getText("detailLineItemTableHeading")}n.setProperty("/lineItemListTitle",t);s=r.getContexts();i=s.reduce(a,0);n.setProperty("/totalOrderAmount",i)}},_onObjectMatched:function(e){var t=e.getParameter("arguments");let i=t.ID;var o=this.byId("items12");i="/InvoiceHeaders("+i+")";var n=this.getView().byId("_IDGenColumnListItem112").clone();o.bindItems(i+"/to_items",n);this.byId("_IDGenHorizontalLayout").bindContext({path:i})},_bindView:function(e){var t=this.getModel("detailView");t.setProperty("/busy",false);this.getView().bindElement({path:e,parameters:{expand:"Customer,Order_Details/Product,Employee"},events:{change:this._onBindingChange.bind(this),dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=e.getElementBinding();if(!t.getBoundContext()){this.getRouter().getTargets().display("detailObjectNotFound");this.getOwnerComponent().oListSelector.clearMasterListSelection();return}var i=t.getPath(),o=this.getResourceBundle(),n=e.getModel().getObject(i),r=n.OrderID,a=n.OrderID,s=this.getModel("detailView");this.getOwnerComponent().oListSelector.selectAListItem(i);s.setProperty("/shareSendEmailSubject",o.getText("shareSendEmailObjectSubject",[r]));s.setProperty("/shareSendEmailMessage",o.getText("shareSendEmailObjectMessage",[a,r,location.href,n.ShipName,n.EmployeeID,n.CustomerID]))},_onMetadataLoaded:function(){var e=this.getView().getBusyIndicatorDelay(),t=this.getModel("detailView"),i=this.byId("lineItemsList"),o=i.getBusyIndicatorDelay();t.setProperty("/delay",0);t.setProperty("/lineItemTableDelay",0);i.attachEventOnce("updateFinished",function(){t.setProperty("/lineItemTableDelay",o)});t.setProperty("/busy",true);t.setProperty("/delay",e)},onTabSelect:function(e){var t=e.getParameter("selectedKey");this.getRouter().navTo("object",{objectId:this._sObjectId,query:{tab:t}},true)},_onHandleTelephonePress:function(e){var t=e.getSource().getText();r.triggerTel(t)},onCloseDetailPress:function(){this.getModel("appView").setProperty("/actionButtonsInfo/midColumn/fullScreen",false);this.getOwnerComponent().oListSelector.clearMasterListSelection();this.getRouter().navTo("master")},toggleFullScreen:function(){var e=this.getModel("appView").getProperty("/actionButtonsInfo/midColumn/fullScreen");this.getModel("appView").setProperty("/actionButtonsInfo/midColumn/fullScreen",!e);if(!e){this.getModel("appView").setProperty("/previousLayout",this.getModel("appView").getProperty("/layout"));this.getModel("appView").setProperty("/layout","MidColumnFullScreen")}else{this.getModel("appView").setProperty("/layout",this.getModel("appView").getProperty("/previousLayout"))}},onNavBack:function(){const e=n.getInstance().getPreviousHash();if(e!==undefined){window.history.go(-1)}else{this.getOwnerComponent().getRouter().navTo("RouteWorkList",{},undefined,true)}}})});
//# sourceMappingURL=Detail.controller.js.map