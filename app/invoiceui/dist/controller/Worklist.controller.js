sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","invoiceui/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/routing/History"],function(e,t,n,o,i,s,r,l){"use strict";return e.extend("invoiceui.controller.Worklist",{formatter:n,onInit:function(){var e,n,s=this.byId("table");n=s.getBusyIndicatorDelay();this._oTable=s;this._aTableSearchState=[];e=new t({worklistTableTitle:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("worklistTableTitle"),shareOnJamTitle:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("worklistTitle"),shareSendEmailSubject:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("shareSendEmailWorklistSubject"),shareSendEmailMessage:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("shareSendEmailWorklistMessage",[location.href]),tableNoDataText:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("tableNoDataText"),tableBusyDelay:0,inStock:0,shortage:0,outOfStock:0,countAll:0});this.getView().setModel(e,"worklistView");this._mFilters={inStock:[new o("UnitsInStock",i.GT,10)],outOfStock:[new o("UnitsInStock",i.LE,0)],shortage:[new o("UnitsInStock",i.BT,1,10)],all:[]};s.attachEventOnce("updateFinished",function(){})},onUpdateFinished:function(e){},onPress:function(e){this._showObject(e.getSource())},onNavBack:function(){history.go(-1)},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var n=e.getParameter("query");if(n&&n.length>0){t=[new o("ProductName",i.Contains,n)]}this._applySearch(t)}},onRefresh:function(){var e=this.byId("table");e.getBinding("items").refresh()},_showObject:function(e){this.getRouter().navTo("object",{objectId:e.getBindingContext().getProperty("ProductID")})},_applySearch:function(e){var t=this.byId("table"),n=this.getModel("worklistView");t.getBinding("items").filter(e,"Application");if(e.length!==0){n.setProperty("/tableNoDataText",this.getResourceBundle().getText("worklistNoDataWithSearchText"))}},_showErrorMessage:function(e){r.error(e,{styleClass:this.getOwnerComponent().getContentDensityClass()})},onQuickFilter:function(e){var t=this._oTable.getBinding("items"),n=e.getParameter("selectedKey");t.filter(this._mFilters[n])},_handleUnlistActionResult:function(e,t,n,o){if(n===o){s.show(this.getModel("i18n").getResourceBundle().getText("StockRemovedSuccessMsg",[o]))}},_handleReorderActionResult:function(e,t,n,o){if(n===o){s.show(this.getModel("i18n").getResourceBundle().getText("StockUpdatedSuccessMsg",[o]))}},onUnlistObjects:function(){var e,t,n,o,i;e=this.byId("table").getSelectedItems();if(e.length){for(t=0;t<e.length;t++){o=e[t];i=o.getBindingContext().getProperty("ProductID");n=o.getBindingContext().getPath();this.getModel().remove(n,{success:this._handleUnlistActionResult.bind(this,i,true,t+1,e.length),error:this._handleUnlistActionResult.bind(this,i,false,t+1,e.length)})}}else{this._showErrorMessage(this.getModel("i18n").getResourceBundle().getText("TableSelectProduct"))}},onUpdateStockObjects:function(){var e,t,n,o;e=this.byId("table").getSelectedItems();if(e.length){for(t=0;t<e.length;t++){n=e[t].getBindingContext().getPath();o=e[t].getBindingContext().getObject();o.UnitsInStock+=10;this.getModel().update(n,o,{success:this._handleReorderActionResult.bind(this,o.ProductID,true,t+1,e.length),error:this._handleReorderActionResult.bind(this,o.ProductID,false,t+1,e.length)})}}else{this._showErrorMessage(this.getModel("i18n").getResourceBundle().getText("TableSelectProduct"))}},onNavBack:function(){const e=l.getInstance().getPreviousHash();if(e!==undefined){window.history.go(-1)}else{this.getOwnerComponent().getRouter().navTo("RouteUpload",{},undefined,true)}},onPressInvoicewf:function(e){var t=this.getOwnerComponent().getRouter();let n=e.getSource().getBindingContext().getProperty("ID");t.navTo("RouteDetail",{ID:e.getSource().getBindingContext().getProperty("ID")})},_handleUnlistActionResult:function(e,t,n,o){if(n===o){s.show(this.getModel("i18n").getResourceBundle().getText("StockRemovedSuccessMsg",[o]))}},onUnlistObjects:function(){var e,t,n,o,i;e=this.byId("table").getSelectedItems();if(e.length){for(t=0;t<e.length;t++){o=e[t];i=o.getBindingContext().getProperty("ProductID");n=o.getBindingContext().getPath();this.getModel().remove(n,{success:this._handleUnlistActionResult.bind(this,i,true,t+1,e.length),error:this._handleUnlistActionResult.bind(this,i,false,t+1,e.length)})}}else{this._showErrorMessage(this.getModel("i18n").getResourceBundle().getText("TableSelectProduct"))}},onUpdateStockObjects:function(){var e,t,n,o;e=this.byId("table").getSelectedItems();if(e.length){for(t=0;t<e.length;t++){n=e[t].getBindingContext().getPath();o=e[t].getBindingContext().getObject();o.UnitsInStock+=10;this.getModel().update(n,o,{success:this._handleReorderActionResult.bind(this,o.ProductID,true,t+1,e.length),error:this._handleReorderActionResult.bind(this,o.ProductID,false,t+1,e.length)})}}else{this._showErrorMessage(this.getModel("i18n").getResourceBundle().getText("TableSelectProduct"))}}})});
//# sourceMappingURL=Worklist.controller.js.map